/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@supabase/supabase-js@2.58.0/dist/module/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{FunctionsClient as e}from"/npm/@supabase/functions-js@2.5.0/+esm";export{FunctionRegion,FunctionsError,FunctionsFetchError,FunctionsHttpError,FunctionsRelayError}from"/npm/@supabase/functions-js@2.5.0/+esm";import{PostgrestClient as t}from"/npm/@supabase/postgrest-js@1.21.4/+esm";export{PostgrestError}from"/npm/@supabase/postgrest-js@1.21.4/+esm";import{RealtimeClient as n}from"/npm/@supabase/realtime-js@2.15.5/+esm";export*from"/npm/@supabase/realtime-js@2.15.5/+esm";import{StorageClient as s}from"/npm/@supabase/storage-js@2.12.2/+esm";import r,{Headers as o}from"/npm/@supabase/node-fetch@2.6.15/+esm";import{AuthClient as i}from"/npm/@supabase/auth-js@2.72.0/+esm";export*from"/npm/@supabase/auth-js@2.72.0/+esm";var a="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}var h=u,l=c;function f(e){if(h===setTimeout)return setTimeout(e,0);if((h===u||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}"function"==typeof a.setTimeout&&(h=setTimeout),"function"==typeof a.clearTimeout&&(l=clearTimeout);var d,p=[],m=!1,g=-1;function b(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&v())}function v(){if(!m){var e=f(b);m=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,m=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===c||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function w(e,t){this.fun=e,this.array=t}w.prototype.run=function(){this.fun.apply(null,this.array)};function y(){}var T=y,k=y,j=y,O=y,U=y,E=y,A=y;var R=a.performance||{},S=R.now||R.mozNow||R.msNow||R.oNow||R.webkitNow||function(){return(new Date).getTime()};var C=new Date;var _={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new w(e,t)),1!==p.length||m||f(v)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:T,addListener:k,once:j,off:O,removeListener:U,removeAllListeners:E,emit:A,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*S.call(R),n=Math.floor(t),s=Math.floor(t%1*1e9);return e&&(n-=e[0],(s-=e[1])<0&&(n--,s+=1e9)),[n,s]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-C)/1e3}};let x="";x="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const L={headers:{"X-Client-Info":`supabase-js-${x}/2.58.0`}},K={schema:"public"},N={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},F={};var I=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((s=s.apply(e,t||[])).next())}))};const P=e=>{let t;return t=e||("undefined"==typeof fetch?r:fetch),(...e)=>t(...e)},H=(e,t,n)=>{const s=P(n),r="undefined"==typeof Headers?o:Headers;return(n,o)=>I(void 0,void 0,void 0,(function*(){var i;const a=null!==(i=yield t())&&void 0!==i?i:e;let u=new r(null==o?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),s(n,Object.assign(Object.assign({},o),{headers:u}))}))};var D=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((s=s.apply(e,t||[])).next())}))};class z extends i{constructor(e){super(e)}}var $=function(e,t,n,s){return new(n||(n=Promise))((function(r,o){function i(e){try{u(s.next(e))}catch(e){o(e)}}function a(e){try{u(s.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}u((s=s.apply(e,t||[])).next())}))};class G{constructor(e,n,r){var o,i,a;this.supabaseUrl=e,this.supabaseKey=n;const u=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((n=t).endsWith("/")?n:n+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var n}(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const c=`sb-${u.hostname.split(".")[0]}-auth-token`,h=function(e,t){var n,s;const{db:r,auth:o,realtime:i,global:a}=e,{db:u,auth:c,realtime:h,global:l}=t,f={db:Object.assign(Object.assign({},u),r),auth:Object.assign(Object.assign({},c),o),realtime:Object.assign(Object.assign({},h),i),storage:{},global:Object.assign(Object.assign(Object.assign({},l),a),{headers:Object.assign(Object.assign({},null!==(n=null==l?void 0:l.headers)&&void 0!==n?n:{}),null!==(s=null==a?void 0:a.headers)&&void 0!==s?s:{})}),accessToken:()=>D(this,void 0,void 0,(function*(){return""}))};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}(null!=r?r:{},{db:K,realtime:F,auth:Object.assign(Object.assign({},N),{storageKey:c}),global:L});this.storageKey=null!==(o=h.auth.storageKey)&&void 0!==o?o:"",this.headers=null!==(i=h.global.headers)&&void 0!==i?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=h.auth)&&void 0!==a?a:{},this.headers,h.global.fetch),this.fetch=H(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new t(new URL("rest/v1",u).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new s(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new e(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return $(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:r,storageKey:o,flowType:i,lock:a,debug:u},c,h){const l={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new z({url:this.authUrl.href,headers:Object.assign(Object.assign({},l),c),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,userStorage:r,flowType:i,lock:a,debug:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some((e=>"authorization"===e.toLowerCase()))})}_initRealtimeClient(e){return new n(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=n,this.realtime.setAuth(n))}}const M=(e,t,n)=>new G(e,t,n);(function(){if("undefined"!=typeof window)return!1;const e=_.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");export{G as SupabaseClient,M as createClient};export default null;
//# sourceMappingURL=/sm/a1a7f9f4294c60cc178837825e3da11b9355c889db4c74ddcf856e610247eb09.map